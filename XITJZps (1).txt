getgenv().working = true
while getgenv().working do
    function ClickDet()
        spawn(function()
            local c = game.Players.LocalPlayer.Character
            local closestDistance = math.huge
            local closestClickDetector

            for _, descendant in ipairs(workspace:GetDescendants()) do
                if descendant:IsA("ClickDetector") and descendant.Parent:IsA("BasePart") then
                    local distance = (descendant.Parent.Position - c.PrimaryPart.Position).Magnitude
                    if distance < closestDistance then
                        closestDistance = distance
                        closestClickDetector = descendant
                    end
                end
            end

            if closestClickDetector then
                fireclickdetector(closestClickDetector)
            end
        end)
    end

    local TweenService = game:GetService("TweenService")
    local Players = game:GetService("Players")
    local Workspace = game.Workspace

    local player = Players.LocalPlayer
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

    local groundLevel = humanoidRootPart.Position.Y

    local gifts = {}
    for _, descendant in ipairs(Workspace:GetDescendants()) do
        if descendant:IsA("BasePart") and descendant.Name:match("^Gift_%d+$") then
            table.insert(gifts, descendant)
        end
    end

    local function getDistanceToGift(gift)
        return (humanoidRootPart.Position - gift.Position).magnitude
    end

    local function getTweenDuration(distance)
        if distance > 50 then
            return 10
        else
            return 2
        end
    end

    local function tweenToPosition(targetPosition, duration)
        local targetCFrame = CFrame.new(targetPosition)
        local tweenInfo = TweenInfo.new(duration, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
        local tween = TweenService:Create(humanoidRootPart, tweenInfo, {CFrame = targetCFrame})
        tween:Play()
        tween.Completed:Wait()
    end

    task.spawn(function()
        local closestGift = nil
        local closestDistance = math.huge

        for _, gift in ipairs(gifts) do
            local distance = getDistanceToGift(gift)
            if distance < closestDistance then
                closestDistance = distance
                closestGift = gift
            end
        end

        if closestGift then
            local horizontalPosition = Vector3.new(closestGift.Position.X, groundLevel, closestGift.Position.Z)
            local horizontalTweenDuration = getTweenDuration(closestDistance)
            tweenToPosition(horizontalPosition, horizontalTweenDuration)

            local verticalTweenDuration = getTweenDuration(closestDistance)
            tweenToPosition(closestGift.Position, verticalTweenDuration)
            task.wait(1)
            ClickDet()
            task.wait(5)
        end
    end)
    wait(8)
end